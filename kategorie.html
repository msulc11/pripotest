<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PRIPO Quiz - Kategorie</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>PRIPO - Test znalostí</h1>
            <p>Vyberte si kategorii pro testování.</p>
            <a href="index.html" class="back-btn">Zpět na úvod</a>
        </header>

        <main>
            <div id="categories-section">
                <div class="categories-container" id="categories-container">
                    <!-- Kategorie budou dynamicky generovány zde -->
                    <p>Načítání kategorií...</p>
                </div>
            </div>

            <div class="quiz-container" id="quiz-container" style="display: none;">
                <div class="question-section">
                    <h2 id="question-title">Načítání otázky...</h2>
                    <div class="question-category" id="question-category"></div>
                </div>

                <div class="answers-section" id="answers-section">
                    <!-- Answers will be dynamically generated here -->
                </div>

                <div class="navigation">
                    <button id="prev-btn" class="nav-btn" disabled>Předchozí</button>
                    <button id="next-btn" class="nav-btn">Další</button>
                    <button id="finish-btn" class="nav-btn finish-btn" style="display: none;">Dokončit test</button>
                </div>
            </div>

            <div class="results-container" id="results-container" style="display: none;">
                <h2>Výsledky testu</h2>
                <div class="score-display">
                    <div class="score-circle">
                        <span id="final-score">0%</span>
                    </div>
                </div>
                <div class="score-details">
                    <p>Správných odpovědí: <span id="correct-answers">0</span> z <span id="total-answered">0</span></p>
                    <p>Celkový počet otázek: <span id="total-questions-result">0</span></p>
                </div>
                <button id="restart-btn" class="nav-btn">Začít znovu</button>
                <button id="review-btn" class="nav-btn">Zkontrolovat odpovědi</button>
                <button id="back-to-categories-btn" class="nav-btn">Zpět k kategoriím</button>
            </div>

            <div class="review-container" id="review-container" style="display: none;">
                <h2>Přehled odpovědí</h2>
                <div id="review-content"></div>
                <button id="back-to-results-btn" class="nav-btn">Zpět k výsledkům</button>
                <button id="back-to-categories-review-btn" class="nav-btn">Zpět k kategoriím</button>
            </div>
        </main>
    </div>

    <script src="questions.js"></script>
    <script src="script.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const categoriesContainer = document.getElementById('categories-container');
            const categoriesSection = document.getElementById('categories-section');
            const quizContainer = document.getElementById('quiz-container');
            const resultsContainer = document.getElementById('results-container');
            const reviewContainer = document.getElementById('review-container');
            
            let selectedCategory = null;
            let filteredQuestions = [];

            // Seskupit otázky podle kategorie
            const categoryMap = {};
            questions.forEach(question => {
                const cat = question.category;
                if (!categoryMap[cat]) {
                    categoryMap[cat] = 0;
                }
                categoryMap[cat]++;
            });

            // Vygenerovat tlačítka kategorií
            categoriesContainer.innerHTML = '';
            Object.keys(categoryMap).sort().forEach(category => {
                const count = categoryMap[category];
                const btn = document.createElement('button');
                btn.className = 'category-btn';
                btn.textContent = `${category} (${count} otázek)`;
                btn.addEventListener('click', function() {
                    selectedCategory = category;
                    filteredQuestions = questions.filter(q => q.category === category);
                    categoriesSection.style.display = 'none';
                    quizContainer.style.display = 'block';
                    
                    // Inicializovat quiz s filtrovанными otázkami
                    if (typeof initQuiz === 'function') {
                        initQuiz(filteredQuestions);  // Předpokládá, že script.js má funkci initQuiz(questions)
                    } else {
                        // Pokud initQuiz není definováno, použij standardní inicializaci (uprav podle script.js)
                        currentQuestionIndex = 0;
                        totalQuestions = filteredQuestions.length;
                        loadQuestion();
                        updateProgress();
                        updateQuestionCounter();
                    }
                });
                categoriesContainer.appendChild(btn);
            });

            if (Object.keys(categoryMap).length === 0) {
                categoriesContainer.innerHTML = '<p>Žádné kategorie nenalezeny.</p>';
            }

            // Přidat event listenery pro zpět tlačítka
            document.getElementById('back-to-categories-btn').addEventListener('click', function() {
                resultsContainer.style.display = 'none';
                categoriesSection.style.display = 'block';
                quizContainer.style.display = 'none';
                selectedCategory = null;
                filteredQuestions = [];
            });

            document.getElementById('back-to-categories-review-btn').addEventListener('click', function() {
                reviewContainer.style.display = 'none';
                categoriesSection.style.display = 'block';
                quizContainer.style.display = 'none';
                selectedCategory = null;
                filteredQuestions = [];
            });
        });
    </script>
</body>
</html>
